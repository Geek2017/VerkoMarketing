!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=9)}([function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}e.exports=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}},function(e,t,n){var i=n(4),o=n(5),r=n(6),s=n(8);e.exports=function(e,t){return i(e)||o(e,t)||r(e,t)||s()}},function(e,t){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),i=1;i<arguments.length;i++){var o=arguments[i];if(null!=o)for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(n[r]=o[r])}return n},writable:!0,configurable:!0})},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,o=!1,r=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(o)throw r}}return n}}},function(e,t,n){var i=n(7);e.exports=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){"use strict";n.r(t);n(3);var i=n(0),o=n.n(i),r=n(2),s=n.n(r),a=n(1),c=n.n(a),u=function(){function e(t){o()(this,e),this.init=this.init.bind(this),this.initPixel=this.initPixel.bind(this),this.initFBEvents=this.initFBEvents.bind(this),this.window=t,this.queue=[]}return c()(e,[{key:"init",value:function(e){this.initFBEvents(this.window);var t=this;this.fbPixelId=e.fbPixelId,e.eid&&window.snowplowKW?window.snowplowKW((function(){var e=this.cf;t.domainUserId=e.getDomainUserId(),t.initPixel()})):t.initPixel()}},{key:"initFBEvents",value:function(e){var t,n,i,o,r,s;t=e,n=e.document,i="script",t.fbq||(o=t.fbq=function(){o.callMethod?o.callMethod.apply(o,arguments):o.queue.push(arguments)},t._fbq||(t._fbq=o),o.push=o,o.loaded=!0,o.version="2.0",o.queue=[],(r=n.createElement(i)).async=!0,r.src="//connect.facebook.net/en_US/fbevents.js",(s=n.getElementsByTagName(i)[0]).parentNode.insertBefore(r,s))}},{key:"initPixel",value:function(){var e={};this.domainUserId&&(e.external_id=this.domainUserId),this.window.fbq("init",this.fbPixelId,e),this.emptyQueue()}},{key:"emptyQueue",value:function(){this.queue&&(this.queue.forEach(function(e){var t=s()(e,3),n=t[0],i=t[1],o=t[2];this.window.fbq(n,this.fbPixelId,i,o)}.bind(this)),this.queue=null)}},{key:"sendCustom",value:function(e,t){this.queue?this.queue.push(["trackSingleCustom",e,t]):this.window.fbq("trackSingleCustom",this.fbPixelId,e,t)}},{key:"send",value:function(e,t){this.queue?this.queue.push(["trackSingle",e,t]):this.window.fbq("trackSingle",this.fbPixelId,e,t)}}]),e}(),l=function e(){o()(this,e),this.appendScriptToDom=function(e,t,n,i,o,r,s){e[o]||(e.GlobalSnowplowNamespace=e.GlobalSnowplowNamespace||[],e.GlobalSnowplowNamespace.push(o),e[o]=function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].q=e[o].q||[],r=t.createElement(n),s=t.getElementsByTagName(n)[0],r.async=1,r.src=i,s.parentNode.insertBefore(r,s))},this.snowplowVersion=function(){var e=this.snowplowSrc&&this.snowplowSrc.match(/sp-(\d+\.\d+\.\d+)\.js/);return e&&e[1]},this.addGlobalContexts=function(e){"2.10.2"===this.snowplowVersion()&&this.winObj.snowplowKW("addGlobalContexts",e)},this.initSnowplow=function(e,t,n,i,o,r){i=i||30,this.winObj=e,this.snowplowSrc=r||"//dc8xl0ndzn2cb.cloudfront.net/sp.js",this.appendScriptToDom(e,e.document,"script",this.snowplowSrc,"snowplowKW"),e.snowplowKW("newTracker","cf","pixel.keywee.co",{appId:t,cookieDomain:n,eventMethod:"get"}),e.snowplowKW("setVisitorCookieTimeout",33696e3),o&&e.snowplowKW("enableActivityTracking",i,i)}},f=function(e){var t=e.getFullYear().toString(),n=(e.getMonth()+1).toString(),i=e.getDate().toString();return t+(n[1]?n:"0"+n[0])+(i[1]?i:"0"+i[0])},h=new Date,d=f(h),g=f(new Date((new Date).setDate(h.getDate()-30))),p=f(new Date(h.getFullYear(),h.getMonth(),1)),w=function(e){return+(Math.round(e+"e+2")+"e-2")},m=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},v=null,y=null,k=null,b=null,S=function(){return y.getStoredObject("keyweeHistory")},_=function(e){y.storeObject("keyweeHistory",e)},C=function(e){var t,n,i=v.document.title,o=v.location.href.indexOf("kwp_4=")>0,r=(t=e||d,S()[t]||{date:t});return r.categories||(r.categories={}),r.categories.general||(r.categories.general={articles_read:0,keywee_articles_read:0,time_spent:0,category:"general"}),(n=r.categories.general).last_visited_article!==i&&(n.articles_read++,o&&n.keywee_articles_read++,n.last_visited_article=i),function(e,t){var n=S();n[e]=t,_(n)}(e||d,r),r},x=function(e,t){var n=S();return function(e,t,n){return Object.keys(e).filter((function(e){return e>=t&&(!n||e<=n)}))}(n,e,t).map((function(e){return n[e]}))},P=function(){var e;C(),e=function(){var e=x(g),t=x(p),n=x(d,d),i=k.getAndUpdateSessionData(new Date),o=function(e){return 1===e.length?m(e[0].categories):e.reduce((function(e,t){return e.concat(m(t.categories))}),[])},r=function(e,t){return 1===e.length?e[0][t]:e.reduce((function(e,n){return e+n[t]}),0)},s=o(e),a=o(t),c=r(o(n),"keywee_articles_read"),u={noad30:e.length,noadcm:t.length,nokart:c,pvps:i.pageViews,slensec:i.sessionLengthSeconds};return["articles_read","keywee_articles_read","time_spent"].forEach((function(e){var t=function(e){return e.split("_").map((function(e){return e[0]})).join("")}(e);[[t+"30d",s],[t+"cm",a]].forEach((function(t){var n=t[0],i=t[1],o=r(i,e);u[n]=w(o)}))})),u=function(e){return e.kar30d>0&&0===e.nokart?e.kru=1:e.kru=0,e}(u)}(),b.sendCustom("KWCEPV",e),b.send("PageView")},E=function(e,t,n,i){var o,r,s;b=i,v=e,y=n,k=t,s={},p<(r=g)&&(r=p),o&&(r=o),x(r).forEach((function(e){s[e.date]=e})),_(s)},I=null,O=function(e,t,n){var i,o,r,s,a,c,u=(i=window.pageYOffset||document.documentElement.scrollTop,o=document.body,r=document.documentElement,s=window.innerHeight,a=Math.max(o.scrollHeight,o.offsetHeight,r.clientHeight,r.scrollHeight,r.offsetHeight),w(Math.min(100,i/(a-s)*100))),l=null,f=u!==I,d=w((new Date-h)/6e4);f&&!(d>30)&&(l={tsop:d,lop:u,noaip:(c=document.getElementsByTagName("iframe"),Array.prototype.slice.call(c).filter((function(e){return e.dataset.googleContainerId})).length),noims:e.getNumberImagesViewed()},t&&(l.erps=t.getEstimatedRevPerSession()),n.sendCustom("KWCEPA",l),I=u)},j=function(e,t,n,i){var o=1e3*(e=e||30);setInterval(O.bind(null,t,n,i),o)},H=function(){function e(t,n){o()(this,e),this.document=t,this.domain=n}return c()(e,[{key:"getCookie",value:function(e){var t=("; "+this.document.cookie).split("; "+e+"=");if(2===t.length)return t.pop().split(";").shift()}},{key:"createCookie",value:function(e,t,n){var i,o;if(n){var r=new Date;r.setTime(r.getTime()+864e5*n),i="; expires="+r.toGMTString()}else i="";o=e+"="+t+i+"; path=/;",this.domain&&(o=o+" Domain="+this.domain),this.document.cookie=o}}]),e}(),T=function(){function e(t,n){o()(this,e),this.localStorageHandler=t,this.window=n,this.document=n.document}return c()(e,[{key:"getNumberImagesViewed",value:function(){var e=this.localStorageHandler.getStoredObject("imagesInfo"),t=e["kw.images_storage"],n=e["kw.current_page_url"],i=this.document.URL,o=e["kw.max_images_per_page"],r=0,s=0;t&&(s=t),o&&(r=o);var a=this.getCurrentAmountOfImages();if(n===i){if(!(a>r))return s;s=s-r+a}else s+=a,e["kw.current_page_url"]=i;return e["kw.images_storage"]=s,e["kw.max_images_per_page"]=a,this.localStorageHandler.storeObject("imagesInfo",e),s}},{key:"getCurrentAmountOfImages",value:function(){var e=this.window,t=this.document.getElementsByTagName("img");return Array.prototype.slice.call(t).filter((function(e){return e.getBoundingClientRect().top<0})).filter((function(t){return t.height/e.screen.availHeight*100>10&&t.width/e.screen.availWidth*100>10})).length}}]),e}(),q=function(){function e(t,n){o()(this,e),this.cookieHandler=t,this.localStorageHandler=n}return c()(e,[{key:"initSessionData",value:function(e){this.cookieHandler.createCookie("kw.session_ts",e,1/48),this.setPageViewsPerSessionCount(1)}},{key:"setPageViewsPerSessionCount",value:function(e){this.cookieHandler.createCookie("kw.pv_session",e,1)}},{key:"getCurrentPageViewPerSession",value:function(){var e=this.cookieHandler.getCookie("kw.pv_session"),t=0;return e&&(t=parseInt(e)),t}},{key:"getAndUpdateSessionData",value:function(e){var t=e.getTime(),n=1,i=0,o=this.getExisitingSessionStart();o?(n=this.getCurrentPageViewPerSession()+1,i=Math.floor((t-o)/1e3),this.setPageViewsPerSessionCount(n)):(this.initSessionData(t),this.localStorageHandler.clearLocalStorage("imagesInfo"));return{pageViews:n,sessionLengthSeconds:i}}},{key:"getExisitingSessionStart",value:function(){var e=this.cookieHandler.getCookie("kw.session_ts"),t=null;return e&&(t=parseInt(e)),t}}]),e}(),D=function(){function e(t){o()(this,e),this.setLocalStorage(t)}return c()(e,[{key:"setLocalStorage",value:function(e){var t,n,i;try{i=(new Date).toString(),(t=e.localStorage).setItem(i,i),n=t.getItem(i)===i,t.removeItem(i),n||(t=!1)}catch(e){}this.storage=t}},{key:"clearLocalStorage",value:function(e){this.storage&&this.storage.removeItem(e)}},{key:"storeObject",value:function(e,t){this.storage&&this.storage.setItem(e,JSON.stringify(t))}},{key:"getStoredObject",value:function(e){var t=this.storage&&this.storage.getItem(e);return t?JSON.parse(t):{}}}]),e}(),U=function(){function e(t){o()(this,e),this.cookieHandler=t}return c()(e,[{key:"fbIdentifierCtx",value:function(){var e=this.cookieHandler.getCookie("_fbp")||"",t=this.cookieHandler.getCookie("_fbc")||"",n=this.cookieHandler.getCookie("keywee.kwp_4")||"";return{schema:"iglu:co.keywee/custom_fb_identifiers/jsonschema/1-0-0",data:{fbp:e.toString(),fbc:t.toString(),kw_aid:n.toString()}}}}]),e}(),V=new function e(t){o()(this,e),this.snowplowManager=new l,this.facebookEventSender=new u(t),this.setKeyweeAdId=function(e){var n=new RegExp("kwp_4=([^&#]*)","i").exec(t.location.href),i=n&&unescape(n[1])||"";""!==i&&this.cookieHandler.createCookie("keywee.kwp_4",i,30),t.snowplowKW&&t.snowplowKW("setUserIdFromCookie","keywee.kwp_4")},this.getConfig=function(e){var n=t.document.createElement("script");n.type="text/javascript",n.src="//cdn.keywee.co/config/"+e+".js",this.testConfigPath&&(n.src=this.testConfigPath),t.document.getElementsByTagName("head")[0].appendChild(n)},this.initiateTracking=function(){var e=this.config,n=this.testDomain||e.domain;this.cookieHandler=new H(t.document,n),this.localStorageHandler=new D(t);var i=new T(this.localStorageHandler,t),o=new q(this.cookieHandler,this.localStorageHandler);if(e.appId){this.snowplowManager.initSnowplow(t,e.appId,n,this.pixelPeriodTimeSec,e.ping_activity,e.snowplow_src),this.setKeyweeAdId(n);var r=new U(this.cookieHandler).fbIdentifierCtx();this.snowplowManager.addGlobalContexts([r])}e.fbPixelId&&(this.facebookEventSender.init(e),e.bt,j(this.pixelPeriodTimeSec,i,null,this.facebookEventSender),E(t,o,this.localStorageHandler,this.facebookEventSender)),this.sendPageView()},this.loadConfig=function(e){this.config=Object.assign(e,this.initOptions),(e.in_eu||!1)&&!this.trackEU||this.initiateTracking()},this.init=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.initOptions=t,this.pixelPeriodTimeSec=t.pixelPeriodTimeSec,this.testDomain=t.testDomain,this.testConfigPath=t.testConfigPath,void 0===t.trackEU?this.trackEU=!0:this.trackEU=t.trackEU,this.getConfig(e)},this.sendPageView=function(){t.snowplowKW&&t.snowplowKW("trackPageView"),this.config.fbPixelId&&P(this.config.fbPixelId)},this.setCustomUrl=function(e){t.snowplowKW&&t.snowplowKW("setCustomUrl",e)},this.applyFunc=function(){try{var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),t=e.slice(1),n=e[0];"initialize"===n?this.init.apply(this,t):"sendPageView"===n?this.sendPageView.apply(this,t):"loadConfig"===n?this.loadConfig.apply(this,t):"setCustomUrl"===n?this.setCustomUrl.apply(this,t):"sendCustomFBEvent"===n?this.facebookEventSender.sendCustom.apply(this.facebookEventSender,t):"sendFBEvent"===n&&this.facebookEventSender.send.apply(this.facebookEventSender,t)}catch(t){n=e[0],console.log("Error in keywee-analytics-tracker occurred trying to run the function ".concat(n,": "),t)}}}(window);window.kwa&&window.kwa.q&&window.kwa.q.forEach((function(e){V.applyFunc.apply(V,e)}));window.kwa=V.applyFunc.bind(V)}]);
//# sourceMappingURL=analytics.min.js.map